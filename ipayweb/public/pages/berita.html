<script type="text/javascript">
var daftar_prod = $("#daftar-produk").DataTable();
var daftar_sup = $("#daftar-supplier").DataTable();
 function loadTabelSup(){
    $.ajax({
      url:'getSupplier',
      type:'post',
      success:function(result){
        alert(result);
        var res = JSON.parse(result);
        $.each(res,function(key,val){
          var ph = "-";
          if(val.ph!=null){
            ph = val.ph;
          }
          var em = "-";
          if(val.em!=null){
            em = val.em;
          }
          var deposit = setComma(val.total_deposit);
          daftar_sup.row.add([
            val.id_sup,
            val.nama_supplier,
            deposit,
            val.pic,
            em,
            ph,
            val.jalan+", "+val.kec+", "+val.kab+", "+val.prov,
            "edit"
            ]).draw(false);
        });
      }
    });
  }
  $(document).ready(function(){
    loadTabelSup();
  
  });
</script>
<div class="page-header">Atur Supplier</div>
<div class="row" id="data-filter-area">

</div>
<div class="panel panel-default col-md-12" id="panel-add-supplier">
  <div class="panel-heading" id="add-produk-heading">Tambah Supplier <button id="add-produk-btn" class="btn btn-primary" onclick="showAdd()">Buka</button></div>
  <div class="panel-body sup-panel" id="body-tambah-produk" style="display: none">
    <form id="form-add-supplier">
      <div class="col-md-6">
        <div class="row">
          <div class="col-md-6">
            Id Supplier
          </div>
          <div class="col-md-6">
            <input class="form-control" name="id_supplier">
          </div>
        </div>
        <div class="row">
          <div class="col-md-6">
            Nama Supplier
          </div>
          <div class="col-md-6">
            <input class="form-control" name="nama_supplier">
          </div>
        </div>
        <div class="row">
          <div class="col-md-6">
            Deposit
          </div>
          <div class="col-md-6">
            <input class="form-control" name="deposit">
          </div>
        </div>

        <div class="row">
          <div class="col-md-6">
            Kontak PIC
          </div>
          <div class="col-md-6">
            <div class="input-group">
              <input type="text" class="form-control" placeholder="Nama PIC" name="pic_supplier">              
              <span class="input-group-btn">
                <button class="btn btn-default" type="button" onclick="addContact()">Kontak</button>
              </span>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-md-6">
            Alamat Supplier <i class="glyphicon glyphicon-ok" id="status-alamat" style="color: green; display: none"></i>
          </div>
          <div class="col-md-6">
            <input type="hidden" id="inp-status-alamat">
            <button class="btn btn-default" type="button" onclick="addAddress()">Tambah Alamat</button>
          </div>
        </div>
      </div>
      <div class="col-md-6">
        <div class="row">
          <div class="col-md-4">
            Supplier Gateway
          </div>
          <div class="col-md-8">
            <input type="text" name="nama_gateway" class="btn btn-default" value="Tambah">
            <table class="table table-striped">
              <thead>
                <tr>
                  <td>Nama</td>
                  <td>Metode</td>
                  <td>Opt</td>
                </tr>
              </thead>
              <tbody id="sup-gateway-body">
                
              </tbody>
            </table>
          </div>
        </div>
        
      </div>
    </form>
  </div>

</div>
<div class="panel panel-default col-md-12 sup-panel" id="panel-daftar-supplier">
  <div class="panel-heading">Daftar Supplier</div>
  <div class="panel-body">
    <table id="daftar-supplier">
      <thead style="background-color: #275D8D">
        <tr>
          <td width="10%">Id</td>
          <td width="10%">Nama</td>
          <td width="10%">Deposit</td>
          <td width="12.5%">PIC</td>
          <td width="12.5%">Email</td>
          <td width="10%">Telepon</td>
          <td width="30%">Alamat</td>
          <td width="5%">Pilihan</td>
        </tr>
      </thead>
    </table>
  </div>  
</div>
<div class="panel panel-default col-md-12 sup-panel" id="panel-assign-produk" style="display: none">
  <div class="panel-heading">Produk <button onclick="showAddKat()" id="add-kategori-btn" class="btn btn-primary">Buka</button></div>
  <div class="panel-body" id="body-tambah-kategori" style="display: none" >
    <div class="col-md-6">
      <table id="daftar-produk">
        <thead style="background-color: #275D8D">
          <tr>
            <td width="10%">Id</td>
            <td width="15%">Nama</td>
            <td width="15%">Deposit</td>
            <td width="10%">PIC</td>
            <td width="10%">Email</td>
            <td width="10%">Telepon</td>
            <td width="20%">Alamat</td>
            <td width="10%">Pilihan</td>
          </tr>
        </thead>
      </table>
    </div>
    <div class="col-md-6">
      <form id="form-assign-produk">
        <table class="table table-stripe table-hover">
          <thead>
            <tr>
              <td>ID Produk</td>
              <td>Harga</td>
              <td>Prioritas</td>
            </tr>
          </thead>
          <tbody id="assigned-product"></tbody>
        </table>
      </form>
    </div>
    
  </div>  
</div>

<!-- MODAL Supplier Gateway -->
<div id="modal-supplier-gateway" class="modal fade" tabindex="-1" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title">Tambah Saldo</h4>
      </div>
      <div class="modal-body">
        <form id="form-tambah-gatway">
          <div class="row" id="subkategori-row">
            <div class="col-md-6">
              Metode
            </div>
            <div class="col-md-6">
              <select class="form-control" name="metode_gateway">
                <option value="xml">XML</option>
                <option value="h2h">Host To Host</option>
                <option value="ym">Yahoo Messenger</option>
                <option value="web">Web</option>
              </select>
            </div>
          </div>
          <div class="row">
            <div class="col-md-6">
              Format Kirim
            </div>
            <div class="col-md-6">
              <textarea class="form-control" name="keterangan"></textarea>
            </div>
          </div>
          
        
          <div class="row">
            <div class="col-md-6">
              
            </div>
            <div class="col-md-6">
              <div id="add-btn">
                <button class="btn btn-primary" type="button" onclick="addProduk()">Tambahkan</button>
              </div>
              <div id="edit-btn" style="display: none">
                <button class="btn btn-success" type="button" onclick="updateProduk()">Simpan</button>
                <button class="btn btn-danger" type="button" onclick="cancelEdit()">Batal</button>
              </div>
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary" onclick="sendSaldo()">Tambahkan</button>
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div>

<!-- MODAL Supplier Address -->


<!-- MODAL Supplier Contact-->


<script type="text/javascript">


  function showAdd(){
    $('#body-tambah-produk').fadeIn(100);
    $('#add-produk-btn').attr('onclick','hideAdd()');
    $('#add-produk-btn').html('Hide');
  }
  function hideAdd(){
    $('#body-tambah-produk').fadeOut(100);
    $('#add-produk-btn').attr('onclick','showAdd()');
    $('#add-produk-btn').html('Buka');
  }
  function tampilSubKat(idsub){
    $('#subkategori-produk').html('')
    var id_kategori = $('#kategori-produk').val();
    $.ajax({
      url:'subKategori',
      type: 'POST',
      data: {'idsubkat': id_kategori},
      success: function(res){
          var subkategori = JSON.parse(res);
          $("#sub-category").html("");
          $.each(subkategori, function(key, val){
              var option = '<option value="'+val.id_kategori+'">'+val.nama_kategori+'</option>';
              if(idsub!=null){
                if(val.id_kategori==idsub){
                  //alert(idsub);
                  option = '<option value="'+val.id_kategori+'" selected="selected">'+val.nama_kategori+'</option>';
                }
              }
              $("#subkategori-produk").append(option);
            
          });
          $('#subkategori-row').show();
        }
    });
    }
  function addProduk(){
    
  }

  function reloadTable(){

  }

  function showAddKat(){
    $('#body-tambah-kategori').fadeIn(100);
    $('#add-kategori-btn').attr('onclick','hideAddKat()');
    $('#add-kategori-btn').html('Hide');
  }
  function hideAddKat(){
    $('#body-tambah-kategori').fadeOut(100);
    $('#add-kategori-btn').attr('onclick','showAddKat()');
    $('#add-kategori-btn').html('Buka');
  }
  function addKategori(){
   
  }
  function editProduk(rowindex){
 
  }

  function updateProduk(){
    
  }

  function cancelEdit(){
    $('#body-tambah-produk').hide();
    $('#panel-add-produk').attr('class','panel panel-default col-md-6');
    $('#add-produk-heading').html('Tambah Produk <button id="add-produk-btn" class="btn btn-primary" onclick="showAdd()">Buka</button>');
    $('#edit-btn').hide();
    $('#add-btn').show();
    updateView();
  }
  function updateView(){
    reloadTable();
    $('input').val('');
    $('#default-kategori').attr('selected','true');
    $('#subkategori-row').hide();
    $('#subkategori-produk').html('');
  }
</script>